{% load static %}

<form method="get" action="{% url 'jobs:job_list' %}" class="space-y-6">
    <!-- Basic Search -->
    <div class="bg-white shadow sm:rounded-lg">
        <div class="px-4 py-5 sm:p-6">
            <h4 class="text-lg font-medium text-gray-900">Search Jobs</h4>
            <div class="mt-6 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6">
                <div class="sm:col-span-4">
                    <label for="search" class="block text-sm font-medium text-gray-700">Keywords</label>
                    <input type="text" name="search" id="search" value="{{ request.GET.search }}"
                           class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                           placeholder="Job title, company, or keywords">
                </div>

                <div class="sm:col-span-2">
                    <label for="location" class="block text-sm font-medium text-gray-700">Location</label>
                    <input type="text" name="location" id="location" value="{{ request.GET.location }}"
                           class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                           placeholder="City, state, or remote">
                </div>
            </div>
        </div>
    </div>

    <!-- Advanced Filters -->
    <div class="bg-white shadow sm:rounded-lg">
        <div class="px-4 py-5 sm:p-6">
            <div class="flex items-center justify-between">
                <h4 class="text-lg font-medium text-gray-900">Advanced Filters</h4>
                <button type="button" id="toggle-filters" class="text-sm text-blue-600 hover:text-blue-800">
                    Show Filters
                </button>
            </div>

            <div id="advanced-filters" class="mt-6 hidden">
                <div class="grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6">
                    <!-- Salary Range -->
                    <div class="sm:col-span-3">
                        <label for="salary_min" class="block text-sm font-medium text-gray-700">Minimum Salary</label>
                        <div class="mt-1 relative rounded-md shadow-sm">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <span class="text-gray-500 sm:text-sm">$</span>
                            </div>
                            <input type="number" name="salary_min" id="salary_min" value="{{ request.GET.salary_min }}"
                                   class="mt-1 block w-full pl-7 border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                                   placeholder="0">
                        </div>
                    </div>

                    <div class="sm:col-span-3">
                        <label for="salary_max" class="block text-sm font-medium text-gray-700">Maximum Salary</label>
                        <div class="mt-1 relative rounded-md shadow-sm">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <span class="text-gray-500 sm:text-sm">$</span>
                            </div>
                            <input type="number" name="salary_max" id="salary_max" value="{{ request.GET.salary_max }}"
                                   class="mt-1 block w-full pl-7 border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                                   placeholder="100000">
                        </div>
                    </div>

                    <!-- Job Type -->
                    <div class="sm:col-span-3">
                        <label for="job_type" class="block text-sm font-medium text-gray-700">Job Type</label>
                        <select name="job_type" id="job_type"
                                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                            <option value="">All Types</option>
                            <option value="full-time" {% if request.GET.job_type == 'full-time' %}selected{% endif %}>Full Time</option>
                            <option value="part-time" {% if request.GET.job_type == 'part-time' %}selected{% endif %}>Part Time</option>
                            <option value="contract" {% if request.GET.job_type == 'contract' %}selected{% endif %}>Contract</option>
                            <option value="internship" {% if request.GET.job_type == 'internship' %}selected{% endif %}>Internship</option>
                        </select>
                    </div>

                    <!-- Experience Level -->
                    <div class="sm:col-span-3">
                        <label for="experience_level" class="block text-sm font-medium text-gray-700">Experience Level</label>
                        <select name="experience_level" id="experience_level"
                                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                            <option value="">All Levels</option>
                            <option value="entry" {% if request.GET.experience_level == 'entry' %}selected{% endif %}>Entry Level</option>
                            <option value="mid" {% if request.GET.experience_level == 'mid' %}selected{% endif %}>Mid Level</option>
                            <option value="senior" {% if request.GET.experience_level == 'senior' %}selected{% endif %}>Senior Level</option>
                            <option value="lead" {% if request.GET.experience_level == 'lead' %}selected{% endif %}>Lead</option>
                            <option value="manager" {% if request.GET.experience_level == 'manager' %}selected{% endif %}>Manager</option>
                        </select>
                    </div>

                    <!-- Skills -->
                    <div class="sm:col-span-6">
                        <label for="skills" class="block text-sm font-medium text-gray-700">Required Skills</label>
                        <select name="skills" id="skills" multiple
                                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                            {% for skill in skills %}
                            <option value="{{ skill.id }}" {% if skill.id|stringformat:"s" in request.GET.skills %}selected{% endif %}>
                                {{ skill.name }}
                            </option>
                            {% endfor %}
                        </select>
                    </div>

                    <!-- Date Posted -->
                    <div class="sm:col-span-3">
                        <label for="date_posted" class="block text-sm font-medium text-gray-700">Date Posted</label>
                        <select name="date_posted" id="date_posted"
                                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                            <option value="">Any Time</option>
                            <option value="1" {% if request.GET.date_posted == '1' %}selected{% endif %}>Last 24 hours</option>
                            <option value="7" {% if request.GET.date_posted == '7' %}selected{% endif %}>Last 7 days</option>
                            <option value="30" {% if request.GET.date_posted == '30' %}selected{% endif %}>Last 30 days</option>
                            <option value="90" {% if request.GET.date_posted == '90' %}selected{% endif %}>Last 90 days</option>
                        </select>
                    </div>

                    <!-- Sort By -->
                    <div class="sm:col-span-3">
                        <label for="sort_by" class="block text-sm font-medium text-gray-700">Sort By</label>
                        <select name="sort_by" id="sort_by"
                                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                            <option value="relevance" {% if request.GET.sort_by == 'relevance' %}selected{% endif %}>Relevance</option>
                            <option value="date" {% if request.GET.sort_by == 'date' %}selected{% endif %}>Date Posted</option>
                            <option value="salary" {% if request.GET.sort_by == 'salary' %}selected{% endif %}>Salary</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="flex justify-end">
        <button type="submit" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
            Search Jobs
        </button>
    </div>
</form>

{% block extra_js %}
<script>
    document.getElementById('toggle-filters').addEventListener('click', function() {
        const filters = document.getElementById('advanced-filters');
        const button = this;
        if (filters.classList.contains('hidden')) {
            filters.classList.remove('hidden');
            button.textContent = 'Hide Filters';
        } else {
            filters.classList.add('hidden');
            button.textContent = 'Show Filters';
        }
    });

    $(document).ready(function() {
        $('#skills').select2({
            placeholder: 'Select skills',
            allowClear: true,
            tags: true
        });
    });
</script>
{% endblock %} 